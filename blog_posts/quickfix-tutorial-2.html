<div class="body">
	<p>
	In <a href="/blog/post/3/?building-your-first-eclipse-quick-fix">part one</a> of three, I covered the basics of making a quickfix pattern for a bug - 
	starting with parsing the Abstract Syntax Tree (AST) and ending with creating a new <code>ASTNode</code> to replace the broken code.
	In part two, this tutorial, we will be tackling a slightly more complicated bug that needs resolving:
	<img src="images/quickfix-insecure-random.gif" />

	Resolving this bug will demonstrate offering multiple fixes to users, as well as customizing the descriptions detailed.
	</p>

	<!--end_preview-->

	<h2>One Weird Random QuickFix Recipe (that will totally be clickbait)</h2>
    <div class="recipe">
        <dl>
            <dt>Preparation time</dt>
            <dd>5m</dd>
            <dt>Coding time</dt>
            <dd>10m</dd>
            <dt>Difficulty</dt>
            <dd>Hopefully getting the hang of this</dd>
            <dt>Serves</dt>
            <dd>A light airy second course, before the rich desert</dd>
        </dl>
    </div>

    <p>
    If you've already done the <a href="/blog/post/3/?building-your-first-eclipse-quick-fix">first</a> part, you should have an Eclipse project
    setup already.  
    Otherwise, download <a href="https://docs.google.com/file/d/0B6dzef3D5CTBSjk3MTRPSHZ2SEk">this preconfigured Eclipse workspace</a> and then install the dev version of FindBugs from 
	<a href="https://drive.google.com/file/d/0B6dzef3D5CTBY0J1WTRVRXctVFE/edit">here</a>. <br/>
	If you want to do this in hard mode, follow the <a href="https://github.com/kjlubick/fb-contrib-eclipse-quick-fixes#setting-up-the-project-for-development">dev setup instructions</a> for fb-contrib quickfixes - it will amount to basically the same thing.
	</p>

	<h3>Registering two quickfixes for the BugPattern MDM_RANDOM_SEED</h3>
	<p>
	Just like last time, we'll start by modifying the plugin.xml file.  
	The main difference you will notice is that we register two fixes for the same resolution.  
	This will make both fix options pop up on the list of resolutions.

	<div class="codeContainer">
        <pre data-src="blog_posts/code/quickfix-2-plugin.xml" class="line-numbers" data-line="1,3"></pre>
        <div class="codeComment">
            <span class="mouseComment" data-show="8+15">These are the arguments that differentiate the two fixes.</span>
        </div>
    </div>

    Everything should look similar to the first fix, with on addition, highlighted on lines 8 and 15.  
    These arguments will allow our code to differentiate between which of the two fixes.
    An alternative approach would be to make two classes for each fix, but that seems inelegant and prone to code duplication, especially for the visitor.

	</p>

	<h3>Making the two fixes</h3>
	<p>
	To make two separate fixes, we'll need to override <code>setOptions()</code> to distinguish between them and then code in the separate fixes.
	</p>

	<div class="codeContainer" style="max-height:500px;">
        <pre data-src="blog_posts/code/quickfix-2-randomResolution1.java" class="line-numbers" data-line="1,3"></pre>
        <div class="codeComment">
            <span class="mouseComment" data-show="7">
            	We will need <code>TypeBinding</code>s for the visitor implementation below.
            </span>
            <span class="mouseComment" data-show="11-13">
            	This method handles the parsing of any arguments you pass in. 
            	The arguments will be parsed as comma-separated, if you need more than one.
            </span>
            <span class="mouseComment" data-show="23-28">
            	And we simply use the parsed argument from above to determine the fix to apply.
            </span>
			<span class="mouseComment" data-show="31">
            	This call is from the FindBugs plugin.eclipse.quickfix.util.ASTUtil class
            	and will add, if it doesn't already exist, a reference to SecureRandom.
            </span>

			<span class="mouseComment" data-show="35-38">
            	This is a simple way to create a constructor invocation of SecureRandom.
            	One downside is that it won't deal with imports, potentially leaving a compilation error.  
            	Line 31 corrects this oversight.
            </span>

            <span class="mouseComment" data-show="42-44">
            	Makes a call to <code>new Random()</code>
            </span>

			<span class="mouseComment" data-show="46-49">
            	Chains a newly created SecureRandom to a call of nextLong:
            	 <code>new SecureRandom().</code><br/><code>nextLong()</code>
            </span>

            <span class="mouseComment" data-show="51">
            	Takes the output of the long generated from the <code>SecureRandom</code>
            	and uses that to initialize the <code>Random</code> object we made in 42-44.
            </span>
        </div>
    </div>
</div>


<script src="js/libs/prism.js"></script>
<script src="js/codeCommentary.js"></script>